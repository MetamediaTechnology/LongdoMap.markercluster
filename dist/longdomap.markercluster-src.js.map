{"version":3,"sources":["webpack://lmc/webpack/bootstrap","webpack://lmc/./src/LLBBox.js","webpack://lmc/./src/MarkerCluster.js","webpack://lmc/./src/index.js"],"names":["longdo","window","locations","arguments","length","Array","_projection","Projections","EPSG3857","_locationList","_bounds","Util","locationBound","minLon","minLat","maxLon","maxLat","location","push","filter","e","empty","bound","add","loc1","loc2","lon","lat","slice","loc","result","contains","getRectVertex","diff","b","maxy","latToNorm","miny","normToLat","y","Math","atan","exp","PI","log","tan","Error","MarkerCluster","map","options","_map","_markers","_clusters","_styles","styles","_prevZoom","_maxZoom","maxZoom","_minClusterSize","minClusterSize","sizes","_ready","_gridSize","gridSize","_averageCenter","_calculator","markers","count","that","_clusterMarkerImage","Image","onload","zoom","resetViewport","_createClusters","src","Event","bind","overlay","len","cl","_clusterIcon","_clusterMarker","getBounds","Marker","m","mapBounds","LLBBox","generateFrom","bounds","getExtendedBounds","isAdded","isLocInBounds","_addToClosestCluster","marker","distance","Number","POSITIVE_INFINITY","clusterToAddTo","cluster","cen","_center","d","isMarkerInClusterBounds","addMarker","Cluster","index","indexOf","Overlays","remove","splice","removed","_removeMarker","markersCopy","r","extendSize","pow","oldClusters","setTimeout","markerCluster","cid","_markerCluster","ClusterIcon","_cid","_calculateBounds","l","active","lenc","updateIcon","generateRect","mz","ml","list","includes","hide","sums","setCenter","setSums","show","_cluster","_visible","_sums","OverlayWeight","Top","pos","move","title","text","setLocation","center","element","children","innerHTML"],"mappings":"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","file":"longdomap.markercluster-src.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","const longdo = window.longdo;\r\nexport default class{\r\n\r\n    constructor(){\r\n        let locations = arguments.length === 0 ? [] :\r\n                        arguments.length === 1 ? \r\n                            (arguments[0] instanceof Array ? arguments[0] : [arguments[0]]) :\r\n                        arguments[0] instanceof Array ? arguments[0] : [arguments[0]];\r\n        this._projection = arguments.length <= 1 ? longdo.Projections.EPSG3857 : arguments[1];\r\n        this._locationList = locations instanceof Array ? locations : [locations];\r\n        if(locations.length > 0){\r\n            this._bounds = longdo.Util.locationBound(this._locationList);\r\n        }\r\n    }\r\n\r\n    getBounds(){\r\n        return {'minLon':this._bounds.minLon,\r\n                'minLat':this._bounds.minLat,\r\n                'maxLon':this._bounds.maxLon,\r\n                'maxLat':this._bounds.maxLat};\r\n    }\r\n\r\n    add(location){\r\n        this._locationList.push(location);\r\n        this._bounds = longdo.Util.locationBound(this._locationList);\r\n    }\r\n    remove(location){\r\n        this._locationList = this._locationList.filter((e) => e !== location);\r\n        this._bounds = this.empty() ? null: longdo.Util.locationBound(this._locationList);\r\n    }\r\n\r\n    empty(){return this._locationList.length === 0;}\r\n\r\n    generateFrom(bound){\r\n        this._locationList.length = 0;\r\n        this.add({\"lon\":bound.minLon,\"lat\":bound.minLat});\r\n        this.add({\"lon\":bound.maxLon,\"lat\":bound.minLat});\r\n        this.add({\"lon\":bound.minLon,\"lat\":bound.maxLat});\r\n        this.add({'lon':bound.maxLon,'lat':bound.maxLat});\r\n        this._bounds = longdo.Util.locationBound(this._locationList);\r\n        return this;\r\n    }\r\n    generateRect(loc1,loc2){\r\n        this._locationList.length = 0;\r\n        this.add({\"lon\":loc1.lon,\"lat\":loc1.lat});\r\n        this.add({\"lon\":loc1.lon,\"lat\":loc2.lat});\r\n        this.add({\"lon\":loc2.lon,\"lat\":loc1.lat});\r\n        this.add({\"lon\":loc2.lon,\"lat\":loc2.lat});\r\n        this._bounds = longdo.Util.locationBound(this._locationList);\r\n        return this;\r\n    }\r\n    getLocations(){\r\n        return this._locationList.slice();\r\n    }\r\n    isLocInBounds(loc){\r\n        const result = longdo.Util.contains(loc,this.getRectVertex());\r\n        return result === null ? true : result;\r\n    }\r\n    extendSize(diff){\r\n        const b = this._bounds;\r\n        const maxy = this._projection.latToNorm(b.maxLat) + diff;\r\n        const miny = this._projection.latToNorm(b.minLat) - diff;\r\n        this._locationList.push({\"lon\":b.minLon - diff,\"lat\": this._projection.normToLat(miny)});\r\n        this._locationList.push({\"lon\":b.minLon - diff,\"lat\": this._projection.normToLat(maxy)});\r\n        this._locationList.push({\"lon\":b.minLon + diff,\"lat\": this._projection.normToLat(miny)});\r\n        this._locationList.push({\"lon\":b.maxLon + diff,\"lat\": this._projection.normToLat(maxy)});\r\n        this._bounds = longdo.Util.locationBound(this._locationList);\r\n        return this;\r\n    }\r\n    getRectVertex(){\r\n        return [{\"lon\":this._bounds.minLon,\"lat\":this._bounds.minLat},\r\n        {\"lon\":this._bounds.minLon,\"lat\":this._bounds.maxLat},\r\n        {\"lon\":this._bounds.maxLon,\"lat\":this._bounds.maxLat},\r\n        {\"lon\":this._bounds.maxLon,\"lat\":this._bounds.minLat}];\r\n    }\r\n\r\n    /*\r\n    Adapted from https://wiki.openstreetmap.org/wiki/Mercator\r\n    */\r\n    _y2lat(y) { return (Math.atan(Math.exp(y / (180 / Math.PI))) / (Math.PI / 4) - 1) * 90; }\r\n    _lat2y(lat) { return Math.log(Math.tan((lat / 90 + 1) * (Math.PI / 4) )) * (180 / Math.PI); }\r\n\r\n}","if(typeof window.longdo === 'undefined'){\r\n    throw new Error('longdo API must be loaded before the longdomap markercluster plugin');\r\n}\r\nconst longdo = window.longdo;\r\nimport LLBBox from \"./LLBBox.js\";\r\nexport default class MarkerCluster{\r\n\r\n    constructor(map, options){\r\n        this._map = map;\r\n        this._markers = [];\r\n        this._clusters = [];\r\n        this._styles = options.styles || [];\r\n        this._prevZoom = 2;\r\n        this._maxZoom = options.maxZoom || null;\r\n        this._minClusterSize = options.minClusterSize || 2;\r\n        this.sizes = [53,56,66,78,90];\r\n        this._ready = false;\r\n        this._gridSize = options.gridSize || 60;\r\n        this._averageCenter = false;\r\n        this._calculator = function(markers){\r\n            const count = markers.length;\r\n            return {'index': 0,'text': ''+ count};\r\n        };\r\n\r\n        const that = this;\r\n        this._clusterMarkerImage = new Image();\r\n        this._clusterMarkerImage.onload = function(){\r\n            that._prevZoom = that._map.zoom;\r\n            that._ready = true;\r\n            that.resetViewport();\r\n            that._createClusters();\r\n        };\r\n        this._clusterMarkerImage.src = './m1.png';\r\n        this._map.Event.bind('zoom', function (/*pivot*/){\r\n            if(!that._ready){return;}\r\n            const zoom = that._map.zoom();\r\n            if(that._prevZoom !== zoom){\r\n                that._prevZoom = zoom;\r\n                that.resetViewport();\r\n                that._createClusters();\r\n            }\r\n        });\r\n        this._map.Event.bind('idle',function() {\r\n            if(!that._ready){return;}\r\n            //that.resetViewport();\r\n            //that._createClusters();\r\n        });\r\n        this._map.Event.bind('drop',function() {\r\n            if(!that._ready){return;}\r\n            that.resetViewport();\r\n            that._createClusters();\r\n        });\r\n        this._map.Event.bind('overlayClick', function(overlay){\r\n            if(!that._ready){return;}\r\n            let len = that._clusters.length;\r\n            while(len--){\r\n                const cl = that._clusters[len];\r\n                if(overlay === cl._clusterIcon._clusterMarker){\r\n                    that._map.bound(cl._bounds.getBounds());\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    addMarkers(markers){\r\n        if(markers instanceof longdo.Marker){\r\n            markers = [markers];\r\n        }\r\n        let len = markers.length;\r\n        while(len--){\r\n            const m = markers[len];\r\n            this._markers.push(m);\r\n        }\r\n    }\r\n    render(){\r\n        this._ready = true;\r\n        this.resetViewport();\r\n        this._createClusters();\r\n    }\r\n    _createClusters(){\r\n        if(!this._ready){return;}\r\n        const mapBounds = new LLBBox().generateFrom(this._map.bound());\r\n        const bounds = this.getExtendedBounds(mapBounds);\r\n        let len = this._markers.length;\r\n        while(len--){\r\n            const m = this._markers[len];\r\n            const loc = m.location();\r\n            if(!m.isAdded && bounds.isLocInBounds(loc)){\r\n                this._addToClosestCluster(m);\r\n            }\r\n        }\r\n    }\r\n    _addToClosestCluster(marker){\r\n        let distance = Number.POSITIVE_INFINITY;\r\n        let clusterToAddTo = null;\r\n        let len = this._clusters.length;\r\n        while(len--){\r\n            const cluster = this._clusters[len];\r\n            const cen = cluster._center;\r\n            if(cen){\r\n                const d = longdo.Util.distance([cen,marker.location()]);\r\n                if(d < distance){\r\n                    distance = d;\r\n                    clusterToAddTo = cluster;\r\n                }\r\n            }\r\n        }\r\n        if(clusterToAddTo && clusterToAddTo.isMarkerInClusterBounds(marker)){\r\n            clusterToAddTo.addMarker(marker);\r\n        }else{\r\n            const cluster = new Cluster(this,this._clusters.length);\r\n            cluster.addMarker(marker);\r\n            this._clusters.push(cluster);\r\n        }\r\n    }\r\n\r\n    _removeMarker(marker){\r\n        const index = this._markers.indexOf(marker);\r\n        if(index === -1){\r\n            return false;\r\n        }\r\n        this._map.Overlays.remove(marker);\r\n        this._markers.splice(index,1);\r\n        return true;\r\n    }\r\n\r\n    removeMarker(marker){\r\n        const removed = this._removeMarker(marker);\r\n        if(removed){\r\n            this.resetViewport();\r\n            this._createClusters();\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    removeMarkers(markers){\r\n        const markersCopy = markers === this._markers ? this._markers.slice() : markers;\r\n        let removed = false;\r\n        let len = markersCopy.length;\r\n        while(len--){\r\n            const r = this._removeMarker(markersCopy[len]);\r\n            removed = removed || r;\r\n        }\r\n        if(removed){\r\n            this.resetViewport();\r\n            this._createClusters();\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    getExtendedBounds(bounds){\r\n        bounds.extendSize(this._gridSize*Math.pow(2,-this._map.zoom()));\r\n        return bounds;\r\n    }\r\n\r\n    clearMarkers(){\r\n        this.resetViewport();\r\n        let len = this._markers.length;\r\n        while(len--){\r\n            let marker = this._markers[len];\r\n            this._map.Overlays.remove(marker);\r\n        }\r\n        this._markers = [];\r\n    }\r\n\r\n    resetViewport(){\r\n        let len = this._clusters.length;\r\n        while(len--){\r\n            this._clusters[len].remove();\r\n        }\r\n        len = this._markers.length;\r\n        while(len--){\r\n            const marker = this._markers[len];\r\n            marker.isAdded = false;\r\n            this._map.Overlays.remove(marker);\r\n        }\r\n        this._clusters = [];\r\n    }\r\n    repaint(){\r\n        const oldClusters = this._clusters().slice();\r\n        this._clusters.length = 0;\r\n        this.resetViewport();\r\n        this._createClusters();\r\n        setTimeout(function() {\r\n            let len = oldClusters.length;\r\n            while(len--){\r\n                oldClusters[len].remove();\r\n            }\r\n        },0);\r\n    }\r\n}\r\n\r\nexport class Cluster{\r\n\r\n    constructor(markerCluster,cid){\r\n        this._markerCluster = markerCluster;\r\n        this._map = markerCluster._map;\r\n        \r\n        this._center = null;\r\n        this._markers = [];\r\n        this._bounds = null;\r\n        this._clusterIcon = new ClusterIcon(this,{},this._markerCluster._gridSize);\r\n        this._cid = cid;\r\n    }\r\n\r\n    addMarker(marker){\r\n        if(this._markers.indexOf(marker) !== -1){\r\n            return false;\r\n        }\r\n        if(!this._center){\r\n            this._center = marker.location();\r\n            this._calculateBounds();\r\n        }else{\r\n            if(this._markerCluster._averageCenter){\r\n                const l = this._markers.length + 1;\r\n                const lat = (this._center.lat * (l-1) + marker.location().lat) / l;\r\n                const lon = (this._center.lon * (l-1) + marker.location().lon) / l;\r\n                this._center = {\"lat\":lat,\"lon\":lon};\r\n                this._calculateBounds();\r\n            }\r\n        }\r\n        marker.isAdded = true;\r\n        this._markers.push(marker);\r\n\r\n        const len = this._markers.length;\r\n        if (len < this._markerCluster._minClusterSize){\r\n            if(!marker.active()){\r\n                this._map.Overlays.add(marker);\r\n            }\r\n        }\r\n        if(len === this._markerCluster._minClusterSize){\r\n            let lenc = len;\r\n            while(lenc--){\r\n                const m = this._markers[lenc];\r\n                if(m.active()){\r\n                    this._map.Overlays.remove(m);\r\n                }\r\n            }\r\n        }\r\n        if(len >= this._markerCluster._minClusterSize){\r\n            let lenc = len;\r\n            while(lenc--){\r\n                const m = this._markers[lenc];\r\n                if(m.active()){\r\n                    this._map.Overlays.remove(m);\r\n                }\r\n            }\r\n        }\r\n        this.updateIcon();\r\n        return true;\r\n    }\r\n    remove(){\r\n        this._clusterIcon.remove();\r\n        this._markers.length = 0;\r\n        delete this._markers;\r\n    }\r\n\r\n    _calculateBounds(){\r\n        this._bounds = \r\n        this._markerCluster.getExtendedBounds(new LLBBox().generateRect(this._center,this._center));\r\n    }\r\n    updateIcon(){\r\n        const zoom = this._map.zoom();\r\n        const mz = this._markerCluster._maxZoom;\r\n        const ml = this._map.Overlays.list();\r\n        if(mz && zoom > mz || zoom === 20){\r\n            let len = this._markers.length;\r\n            while(len--){\r\n                const marker = this._markers[len];\r\n                if(!ml.includes(marker)){\r\n                    this._map.Overlays.add(marker);\r\n                }\r\n            }\r\n            return;\r\n        }\r\n        if(this._markers.length < this._markerCluster._minClusterSize){\r\n            this._clusterIcon.hide();\r\n            return;\r\n        }\r\n        const sums = this._markerCluster._calculator(this._markers,0);\r\n        this._clusterIcon.setCenter(this._center);\r\n        this._clusterIcon.setSums(sums);\r\n        this._clusterIcon.show();\r\n    }\r\n\r\n    isMarkerInClusterBounds(marker){\r\n        return this._bounds.isLocInBounds(marker.location());\r\n    }\r\n    containsMarker(marker){\r\n        let len = this._markers.length;\r\n        while(len--){\r\n            if(this._markers[len] === marker){\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n}\r\nexport class ClusterIcon{\r\n    constructor(cluster,styles){\r\n        this._styles = styles;\r\n        this._cluster = cluster;\r\n        this._center = null;\r\n        this._map = cluster._map;\r\n        this._visible = false;\r\n        this._clusterMarker = null;\r\n        this._sums = null;\r\n        this._clusterMarker = new longdo.Marker({\"lat\":0,\"lon\":0},{\r\n            \"icon\":{\r\n                \"html\": `<div style=\"width:52px;height:52px;background:url(./m1.png) no-repeat center top;color:red;line-height:52px;amrgin:0;padding:0;position:relative;top:-26px;left:-26px;\"><div style='margin-left:22px;'>-1</div></div>`,\r\n                \"offset\": { \"x\": 0, \"y\": 0},\r\n                \"size\": {\"width\":53,\"height\":53}\r\n            },\r\n            \"weight\": longdo.OverlayWeight.Top\r\n        });\r\n    }\r\n\r\n    show(){\r\n        let pos = this._center;\r\n        if(this._clusterMarker.active()){\r\n            this._map.Overlays.move(this._clusterMarker,pos);\r\n            this._clusterMarker.title = '(id:'+this._cluster._cid + ')' + this._sums.text;\r\n        }else{\r\n            this._clusterMarker.setLocation(pos);\r\n            this._map.Overlays.add(this._clusterMarker);\r\n        }\r\n        this._visible = true;\r\n    }\r\n    remove(){\r\n        this._map.Overlays.remove(this._clusterMarker);\r\n    }\r\n    hide(){\r\n        this._map.Overlays.remove(this._clusterMarker);\r\n        this._visible = false;\r\n    }\r\n    setCenter(center){\r\n        this._center = center;\r\n        if(this._clusterMarker){\r\n            this._clusterMarker.move({\"lat\":center.lat,\"lon\":center.lon});\r\n        }\r\n    }\r\n    setSums(sums){\r\n        if(this._sums && sums.text === this._sums.text){return;}\r\n        this._sums = sums;\r\n        this.index = sums.index;\r\n        if(this._clusterMarker && this._clusterMarker.element()){\r\n            this._clusterMarker.element().children[0].children[0].innerHTML = this._sums.text;\r\n            this._clusterMarker.title = `(id:${this._cluster._cid})${this._sums.text}`;\r\n        }\r\n    }\r\n}\r\n","export {default as MarkerCluster,Cluster} from './MarkerCluster.js';\r\nexport {default as LLBBox} from './LLBBox.js';\r\n"],"sourceRoot":""}