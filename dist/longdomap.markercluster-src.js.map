{"version":3,"sources":["webpack://lmc/webpack/bootstrap","webpack://lmc/./src/ConfigHandler.js","webpack://lmc/./src/LLBBox.js","webpack://lmc/./src/MarkerCluster.js","webpack://lmc/./src/index.js"],"names":["options","maxZoom","minClusterSize","gridSize","averageCenter","drawMarkerArea","extraModeEnabled","styles","longdo","window","locations","arguments","length","Array","_projection","Projections","EPSG3857","_locationList","_originalLocationList","slice","_bounds","Util","locationBound","minLon","minLat","maxLon","maxLat","b","location","push","filter","e","empty","bound","add","loc1","loc2","lon","lat","loc","result","contains","getRectVertex","diff","maxy","latToNorm","miny","normToLat","n","isLocInBounds","xlen","ylen","_lat2y","lonoffset","yoffset","xid","Math","floor","yid","y","atan","exp","PI","log","tan","Error","MarkerCluster","map","_map","_markers","_clusters","_prevZoom","_ready","config","Config","_iloader","IconLoader","that","Event","bind","ready","zoom","resetViewport","_createClusters","str","overlay","len","cl","_clusterIcon","_clusterMarker","l","len2","setTimeout","markers","Marker","m","shuffle","i","r","random","temp","mapBounds","LLBBox","generateFrom","bounds","getExtendedBounds","isAdded","_addToClosestCluster","_addToTiledCluster","marker","distance","Number","POSITIVE_INFINITY","clusterToAddTo","cluster","cen","_center","d","isMarkerInClusterBounds","addMarker","Cluster","locationToTile","point","locationToPoint","z","pointToTile","tile","u","v","index","indexOf","Overlays","remove","splice","removed","_removeMarker","markersCopy","extendSize","pow","oldClusters","markerCluster","iloader","_markerCluster","_config","ClusterIcon","_calculateBounds","averageLocation","_gridids","boundOfTile","getNxNGridCord","_markersToShow","markersInSameGrid","forEach","value","gridid","active","updateIcon","lenc","generateRect","mz","hide","sums","setCenter","setSums","show","_cluster","_visible","_sums","getIcon","OverlayWeight","Top","pos","move","setLocation","_poly","Polygon","center","element","changeNumber","markercluster","_images","Map","useDefault","loadStyles","url","width","height","minThreshold","img","Image","set","onload","get","values","every","elm","src","keys","sort","elm1","elm2","style","load","document","createElement","elm3","appendChild","marginLeft","marginTop","overflow","className","html","outerHTML","size","background","encodeURI","lineHeight","color","fontWeight","textAlign","num","children","innerText","list","classList"],"mappings":"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","file":"longdomap.markercluster-src.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/index.js\");\n","export default class {\r\n    constructor(options){\r\n        this.maxZoom = options.maxZoom || null;\r\n        this.minClusterSize = options.minClusterSize || 2;\r\n        this.gridSize = options.gridSize || 120;\r\n        this.averageCenter = options.averageCenter;\r\n        this.drawMarkerArea = options.drawMarkerArea;\r\n        this.extraModeEnabled = options.extraModeEnabled;\r\n        this.styles = options.styles || null;\r\n    }\r\n}","const longdo = window.longdo;\r\nexport default class{\r\n    constructor(){\r\n        let locations = arguments.length === 0 ? [] :\r\n                        arguments.length === 1 ? \r\n                            (arguments[0] instanceof Array ? arguments[0] : [arguments[0]]) :\r\n                        arguments[0] instanceof Array ? arguments[0] : [arguments[0]];\r\n        this._projection = arguments.length <= 1 ? longdo.Projections.EPSG3857 : arguments[1];\r\n        this._locationList = locations instanceof Array ? locations : [locations];\r\n        this._originalLocationList = this._locationList.slice();\r\n        if(locations.length > 0){\r\n            this._bounds = longdo.Util.locationBound(this._locationList);\r\n        }\r\n    }\r\n    getBounds(){\r\n        return {'minLon':this._bounds.minLon,\r\n                'minLat':this._bounds.minLat,\r\n                'maxLon':this._bounds.maxLon,\r\n                'maxLat':this._bounds.maxLat};\r\n    }\r\n    LT(){\r\n        return {\"lon\": this._bounds.minLon, \"lat\": this._bounds.maxLat};\r\n    }\r\n    RT(){\r\n        return {\"lon\": this._bounds.maxLon, \"lat\": this._bounds.maxLat}; \r\n    }\r\n    LB(){\r\n        return {\"lon\": this._bounds.minLon, \"lat\": this._bounds.minLat};\r\n    }\r\n    RB(){\r\n        return {\"lon\": this._bounds.maxLon, \"lat\": this._bounds.minLat};\r\n    }\r\n    getMinimumBounds(){\r\n        const b = longdo.Util.locationBound(this._originalLocationList);\r\n        return b;\r\n    }\r\n\r\n    add(location){\r\n        this._locationList.push(location);\r\n        this._originalLocationList.push(location);\r\n        this._bounds = longdo.Util.locationBound(this._locationList);\r\n    }\r\n    remove(location){\r\n        this._locationList = this._locationList.filter((e) => e !== location);\r\n        this._originalLocationList = this._originalLocationList.filter((e) => e !== location);\r\n        this._bounds = this.empty() ? null: longdo.Util.locationBound(this._locationList);\r\n    }\r\n\r\n    empty(){return this._locationList.length === 0;}\r\n\r\n    generateFrom(bound){\r\n        this._locationList.length = 0;\r\n        this.add({\"lon\":bound.minLon,\"lat\":bound.minLat});\r\n        this.add({\"lon\":bound.maxLon,\"lat\":bound.minLat});\r\n        this.add({\"lon\":bound.minLon,\"lat\":bound.maxLat});\r\n        this.add({'lon':bound.maxLon,'lat':bound.maxLat});\r\n        this._bounds = longdo.Util.locationBound(this._locationList);\r\n        return this;\r\n    }\r\n    generateRect(loc1,loc2){\r\n        if(!loc2){\r\n            loc2 = loc1;\r\n        }\r\n        this._locationList.length = 0;\r\n        this.add({\"lon\":loc1.lon,\"lat\":loc1.lat});\r\n        this.add({\"lon\":loc1.lon,\"lat\":loc2.lat});\r\n        this.add({\"lon\":loc2.lon,\"lat\":loc1.lat});\r\n        this.add({\"lon\":loc2.lon,\"lat\":loc2.lat});\r\n        this._bounds = longdo.Util.locationBound(this._locationList);\r\n        return this;\r\n    }\r\n    getLocations(){\r\n        return this._locationList.slice();\r\n    }\r\n    isLocInBounds(loc){\r\n        const result = longdo.Util.contains(loc,this.getRectVertex());\r\n        return result === null ? true : result;\r\n    }\r\n    extendSize(diff){\r\n        const b = this._bounds;\r\n        const maxy = this._projection.latToNorm(b.maxLat) + diff;\r\n        const miny = this._projection.latToNorm(b.minLat) - diff;\r\n        this._locationList.push({\"lon\":b.minLon - diff,\"lat\": this._projection.normToLat(miny)});\r\n        this._locationList.push({\"lon\":b.minLon - diff,\"lat\": this._projection.normToLat(maxy)});\r\n        this._locationList.push({\"lon\":b.minLon + diff,\"lat\": this._projection.normToLat(miny)});\r\n        this._locationList.push({\"lon\":b.maxLon + diff,\"lat\": this._projection.normToLat(maxy)});\r\n        this._bounds = longdo.Util.locationBound(this._locationList);\r\n        return this;\r\n    }\r\n    getRectVertex(){\r\n        return [{\"lon\":this._bounds.minLon,\"lat\":this._bounds.minLat},\r\n        {\"lon\":this._bounds.minLon,\"lat\":this._bounds.maxLat},\r\n        {\"lon\":this._bounds.maxLon,\"lat\":this._bounds.maxLat},\r\n        {\"lon\":this._bounds.maxLon,\"lat\":this._bounds.minLat}];\r\n    }\r\n\r\n    getNxNGridCord(loc,n){\r\n        if(!this.isLocInBounds(loc)){\r\n            return null;\r\n        }\r\n        const xlen = (this._bounds.maxLon - this._bounds.minLon) / n;\r\n        const ylen = (this._lat2y(this._bounds.maxLat) - this._lat2y(this._bounds.minLat)) / n;\r\n        let lonoffset = loc.lon - this._bounds.minLon;\r\n        const yoffset = -this._lat2y(loc.lat) + this._lat2y(this._bounds.maxLat);\r\n        const xid = Math.floor(lonoffset / xlen), yid = Math.floor(yoffset / ylen);\r\n        return {\"u\": xid,\"v\": yid};\r\n    }\r\n\r\n    /*\r\n    Adapted from https://wiki.openstreetmap.org/wiki/Mercator\r\n    */\r\n    _y2lat(y) { return (Math.atan(Math.exp(y / (180 / Math.PI))) / (Math.PI / 4) - 1) * 90; }\r\n    _lat2y(lat) { return Math.log(Math.tan((lat / 90 + 1) * (Math.PI / 4) )) * (180 / Math.PI); }\r\n\r\n}","if(typeof window.longdo === 'undefined'){\r\n    throw new Error('longdo API must be loaded before the longdomap markercluster plugin');\r\n}\r\nconst longdo = window.longdo;\r\nimport LLBBox from \"./LLBBox.js\";\r\nimport Config from \"./ConfigHandler.js\";\r\nexport default class MarkerCluster{\r\n\r\n    constructor(map, options){\r\n        this._map = map;\r\n        this._markers = [];\r\n        this._clusters = [];\r\n        this._prevZoom = 2;\r\n        this._ready = false;\r\n        this.config = new Config(options);\r\n        this._iloader = new IconLoader(this,this.config);\r\n        \r\n        const that = this;\r\n        this._map.Event.bind('ready',function() {\r\n            if(!that._ready && !that._iloader.ready){return;}\r\n            that._prevZoom = that._map.zoom;\r\n            that.resetViewport();\r\n            that._createClusters();\r\n        });\r\n        this._map.Event.bind('zoom', function (/*pivot*/){\r\n            if(!that._ready && !that._iloader.ready){return;}\r\n            const zoom = that._map.zoom();\r\n            if(that._prevZoom !== zoom){\r\n                that._prevZoom = zoom;\r\n                that.resetViewport();\r\n                that._createClusters();\r\n            }\r\n        });\r\n        this._map.Event.bind('idle',function() {\r\n            if(!that._ready && !that._iloader.ready){return;}\r\n            //that.resetViewport();\r\n            //that._createClusters();\r\n        });\r\n        this._map.Event.bind('drop',function() {\r\n            if(!that._ready && !that._iloader.ready){return;}\r\n            that.resetViewport();\r\n            that._createClusters();\r\n        });/*\r\n        this._map.Event.bind('drag', function(move){\r\n            if(that._ready){\r\n                that.resetViewport();\r\n                that._createClusters();\r\n            }\r\n        });\r\n        */\r\n       this._map.Event.bind('loadTile',function(str) {\r\n            if(str !== 'finish' && !that._ready && !that._iloader.ready){return;}\r\n            that.resetViewport();\r\n            that._createClusters();\r\n        });\r\n        this._map.Event.bind('overlayClick', function(overlay){\r\n            if(!that._ready){return;}\r\n            let len = that._clusters.length;\r\n            while(len--){\r\n                const cl = that._clusters[len];\r\n                if(overlay === cl._clusterIcon._clusterMarker){\r\n                    const l = [];\r\n                    let len2 = cl._markers.length;\r\n                    while(len2--){\r\n                        l.push(cl._markers[len2].location());\r\n                    }\r\n                    //that._map.bound(cl._bounds.getBounds());\r\n                    that._map.bound(longdo.Util.locationBound(l));\r\n                    setTimeout(function(){\r\n                        that.resetViewport();\r\n                        that._createClusters();\r\n                    },0);\r\n                    return;\r\n                }\r\n            }\r\n        });\r\n    }\r\n\r\n    addMarkers(markers){\r\n        if(markers instanceof longdo.Marker){\r\n            markers = [markers];\r\n        }\r\n        let len = markers.length;\r\n        while(len--){\r\n            const m = markers[len];\r\n            this._markers.push(m);\r\n        }\r\n        this.shuffle();\r\n    }\r\n    shuffle(){\r\n        for(let i = this._markers.length-1;i > 0; i--){\r\n            const r = Math.floor(Math.random()*(i+1));\r\n            const temp = this._markers[i];\r\n            this._markers[i] = this._markers[r];\r\n            this._markers[r] = temp;\r\n        }\r\n    }\r\n    render(){\r\n        this._ready = true;\r\n        this.resetViewport();\r\n        this._createClusters();\r\n    }\r\n    _createClusters(){\r\n        if(!this._ready){return;}\r\n        const mapBounds = new LLBBox().generateFrom(this._map.bound());\r\n        const bounds = this.getExtendedBounds(mapBounds);\r\n        let len = this._markers.length;\r\n        while(len--){\r\n            const m = this._markers[len];\r\n            const loc = m.location();\r\n            if(!m.isAdded && bounds.isLocInBounds(loc)){\r\n                if(!this.config.extraModeEnabled){\r\n                    this._addToClosestCluster(m);\r\n                }else{\r\n                    this._addToTiledCluster(m);\r\n                }\r\n                \r\n            }\r\n        }\r\n    }\r\n    _addToClosestCluster(marker){\r\n        let distance = Number.POSITIVE_INFINITY;\r\n        let clusterToAddTo = null;\r\n        let len = this._clusters.length;\r\n        while(len--){\r\n            const cluster = this._clusters[len];\r\n            const cen = cluster._center;\r\n            if(cen){\r\n                const d = longdo.Util.distance([cen,marker.location()]);\r\n                if(d < distance){\r\n                    distance = d;\r\n                    clusterToAddTo = cluster;\r\n                }\r\n            }\r\n        }\r\n        if(clusterToAddTo && clusterToAddTo.isMarkerInClusterBounds(marker)){\r\n            clusterToAddTo.addMarker(marker);\r\n        }else{\r\n            const cluster = new Cluster(this,this.config,this._iloader);\r\n            cluster.addMarker(marker);\r\n            this._clusters.push(cluster);\r\n        }\r\n    }\r\n\r\n    _addToTiledCluster(marker){\r\n        const that = this;\r\n        const locationToTile = function(loc){\r\n            const point = longdo.Util.locationToPoint(longdo.Projections.EPSG3857,loc);\r\n            point.z = 20-that._map.zoom();\r\n            return longdo.Util.pointToTile(point);\r\n        };\r\n        const tile = locationToTile(marker.location());\r\n        let len = this._clusters.length;\r\n        while(len--){\r\n            const cluster = this._clusters[len];\r\n            if(cluster.u === tile.u && cluster.v === tile.v){\r\n                cluster.addMarker(marker,tile);\r\n                return;\r\n            }\r\n        }\r\n        const cluster = new Cluster(this,this.config,this._iloader);\r\n        cluster.u = tile.u;\r\n        cluster.v = tile.v;\r\n        cluster.addMarker(marker,tile);\r\n        this._clusters.push(cluster);\r\n    }\r\n\r\n    _removeMarker(marker){\r\n        const index = this._markers.indexOf(marker);\r\n        if(index === -1){\r\n            return false;\r\n        }\r\n        this._map.Overlays.remove(marker);\r\n        this._markers.splice(index,1);\r\n        return true;\r\n    }\r\n\r\n    removeMarker(marker){\r\n        const removed = this._removeMarker(marker);\r\n        if(removed){\r\n            this.resetViewport();\r\n            this._createClusters();\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    removeMarkers(markers){\r\n        const markersCopy = markers === this._markers ? this._markers.slice() : markers;\r\n        let removed = false;\r\n        let len = markersCopy.length;\r\n        while(len--){\r\n            const r = this._removeMarker(markersCopy[len]);\r\n            removed = removed || r;\r\n        }\r\n        if(removed){\r\n            this.resetViewport();\r\n            this._createClusters();\r\n            return true;\r\n        }\r\n        return false;\r\n    }\r\n\r\n    getExtendedBounds(bounds){\r\n        bounds.extendSize(this.config.gridSize*Math.pow(2,-this._map.zoom()));\r\n        return bounds;\r\n    }\r\n\r\n    clearMarkers(){\r\n        this.resetViewport();\r\n        let len = this._markers.length;\r\n        while(len--){\r\n            const marker = this._markers[len];\r\n            this._map.Overlays.remove(marker);\r\n        }\r\n        this._markers = [];\r\n    }\r\n\r\n    resetViewport(){\r\n        let len = this._clusters.length;\r\n        while(len--){\r\n            this._clusters[len].remove();\r\n        }\r\n        len = this._markers.length;\r\n        while(len--){\r\n            const marker = this._markers[len];\r\n            marker.isAdded = false;\r\n            this._map.Overlays.remove(marker);\r\n        }\r\n        this._clusters = [];\r\n    }\r\n    repaint(){\r\n        const oldClusters = this._clusters().slice();\r\n        this._clusters.length = 0;\r\n        this.resetViewport();\r\n        this._createClusters();\r\n        setTimeout(function() {\r\n            let len = oldClusters.length;\r\n            while(len--){\r\n                oldClusters[len].remove();\r\n            }\r\n        },0);\r\n    }\r\n}\r\n\r\nexport class Cluster{\r\n\r\n    constructor(markerCluster,config,iloader){\r\n        this._markerCluster = markerCluster;\r\n        this._config = config;\r\n        this._map = markerCluster._map;\r\n        \r\n        this._center = null;\r\n        this._markers = [];\r\n        this._bounds = null;\r\n        this._clusterIcon = new ClusterIcon(this,this._config,iloader);\r\n    }\r\n\r\n    addMarker(marker,tile){\r\n        if(this._markers.indexOf(marker) !== -1){\r\n            return false;\r\n        }\r\n        if(!this._center){\r\n            this._center = marker.location();\r\n            this._calculateBounds();\r\n        }else{\r\n            if(this._config.averageCenter){\r\n                this._center = longdo.Util.averageLocation(longdo.Projections.EPSG3857,\r\n                    this._center,marker.location());\r\n            }\r\n        }\r\n        marker.isAdded = true;\r\n        this._markers.push(marker);\r\n\r\n        if(this._config.extraModeEnabled){\r\n            //TODO\r\n            if(!this._gridids){\r\n                this._gridids = [];\r\n            }\r\n            this._gridids.push(new LLBBox().generateFrom(\r\n                longdo.Util.boundOfTile(longdo.Projections.EPSG3857,tile)\r\n            ).getNxNGridCord(marker.location(),4));\r\n\r\n            \r\n            if(!this._markersToShow){\r\n                this._markersToShow = [marker];\r\n            }else if(this._markersToShow.length <= 64){\r\n                let markersInSameGrid = 0;\r\n                const that = this;\r\n                this._gridids.forEach(function(value){\r\n                    const gridid = that._gridids[that._gridids.length-1];\r\n                    markersInSameGrid += gridid.u === value.u && gridid.v === value.v ? 1 : 0;\r\n                });\r\n\r\n                if(markersInSameGrid % 8 !== 0){\r\n                    return true;\r\n                }\r\n                this._markersToShow.push(marker);\r\n            }else{\r\n                return true;\r\n            }\r\n            if(!marker.active()){\r\n                this._map.Overlays.add(marker);\r\n            }\r\n            this.updateIcon();\r\n            return true;\r\n        }\r\n\r\n        const len = this._markers.length;\r\n        if (len < this._config.minClusterSize){\r\n            if(!marker.active()){\r\n                this._map.Overlays.add(marker);\r\n            }\r\n        }\r\n        if(len === this._config.minClusterSize){\r\n            let lenc = len;\r\n            while(lenc--){\r\n                const m = this._markers[lenc];\r\n                if(m.active()){\r\n                    this._map.Overlays.remove(m);\r\n                }\r\n            }\r\n        }\r\n        if(len >= this._config.minClusterSize){\r\n            let lenc = len;\r\n            while(lenc--){\r\n                const m = this._markers[lenc];\r\n                if(m.active()){\r\n                    this._map.Overlays.remove(m);\r\n                }\r\n            }\r\n        }\r\n        this.updateIcon();\r\n        return true;\r\n    }\r\n    remove(){\r\n        this._clusterIcon.remove();\r\n        this._markers.length = 0;\r\n        delete this._markers;\r\n    }\r\n\r\n    _calculateBounds(){\r\n        this._bounds = \r\n        this._markerCluster.getExtendedBounds(new LLBBox().generateRect(this._center));\r\n    }\r\n    updateIcon(){\r\n        const zoom = this._map.zoom();\r\n        const mz = this._config.maxZoom;\r\n        if(mz && zoom > mz || zoom === 20){\r\n            let len = this._markers.length;\r\n            while(len--){\r\n                const marker = this._markers[len];\r\n                if(!marker.active()){\r\n                    this._map.Overlays.add(marker);\r\n                }\r\n            }\r\n            return;\r\n        }\r\n\r\n        if(this._config.extraModeEnabled){\r\n            //TODO\r\n            return;\r\n        }\r\n\r\n        if(this._markers.length < this._config.minClusterSize){\r\n            this._clusterIcon.hide();\r\n            return;\r\n        }\r\n        const sums = this._markers.length;\r\n        this._clusterIcon.setCenter(this._center);\r\n        this._clusterIcon.setSums(sums);\r\n        this._clusterIcon.show();\r\n    }\r\n\r\n    isMarkerInClusterBounds(marker){\r\n        return this._bounds.isLocInBounds(marker.location());\r\n    }\r\n    containsMarker(marker){\r\n        let len = this._markers.length;\r\n        while(len--){\r\n            if(this._markers[len] === marker){\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n}\r\nexport class ClusterIcon{\r\n    constructor(cluster,config,iloader){\r\n        this._cluster = cluster;\r\n        this._config = config;\r\n        this._iloader = iloader;\r\n        this._center = null;\r\n        this._map = cluster._map;\r\n        this._visible = false;\r\n        this._sums = null;\r\n        this._clusterMarker = new longdo.Marker({\"lat\":0,\"lon\":0},{\r\n            \"icon\": this._cluster._markerCluster._iloader.getIcon(0),\r\n            \"weight\": longdo.OverlayWeight.Top\r\n        });\r\n    }\r\n\r\n    show(){\r\n        if(!this._config.extraModeEnabled){\r\n            const pos = this._center;\r\n            if(this._clusterMarker.active()){\r\n                this._map.Overlays.move(this._clusterMarker,pos);\r\n            }else{\r\n                this._clusterMarker.setLocation(pos);\r\n                this._map.Overlays.add(this._clusterMarker);\r\n                if(this._poly){\r\n                    this._map.Overlays.remove(this._poly);\r\n                }\r\n                if(this._config.drawMarkerArea){\r\n                    this._poly = new longdo.Polygon(this._cluster._bounds.getRectVertex(),{});\r\n                    this._map.Overlays.add(this._poly);\r\n                }\r\n            }\r\n            this._visible = true;\r\n        }\r\n    }\r\n    remove(){\r\n        this._map.Overlays.remove(this._clusterMarker);\r\n        if(this._poly){\r\n            this._map.Overlays.remove(this._poly);\r\n            this._poly = null;\r\n        }\r\n    }\r\n    hide(){\r\n        this._map.Overlays.remove(this._clusterMarker);\r\n        this._visible = false;\r\n        if(this._config.drawMarkerArea){\r\n            if(!this._poly){\r\n                this._poly = new longdo.Polygon(this._cluster._bounds.getRectVertex(),{});\r\n            }\r\n            if(!this._poly.active()){\r\n                this._map.Overlays.add(this._poly);\r\n            }\r\n        }\r\n    }\r\n    setCenter(center){\r\n        this._center = center;\r\n        if(this._clusterMarker){\r\n            this._clusterMarker.move({\"lat\":center.lat,\"lon\":center.lon});\r\n        }\r\n    }\r\n    setSums(sums){\r\n        if(this._sums && sums === this._sums){return;}\r\n        this._sums = sums;\r\n        if(this._clusterMarker && this._clusterMarker.element()){\r\n            this._iloader.changeNumber(this._clusterMarker.element(),this._sums);\r\n        }\r\n    }\r\n}\r\n\r\nclass IconLoader{\r\n\r\n    constructor(markercluster,config){\r\n        this._markerCluster = markercluster;\r\n        this._config = config;\r\n        this._images = new Map();\r\n        this.ready = false;\r\n        this.useDefault = true;\r\n        if(this._config.styles){\r\n            this.loadStyles(this._config.styles);\r\n        }\r\n    }\r\n    load(url,width,height,minThreshold){\r\n        this.ready = false;\r\n        this.useDefault = false;\r\n        const img = new Image(width,height);\r\n        this._images.set(img,{\"ready\":false,\"minThreshold\":minThreshold});\r\n        const that = this;\r\n        img.onload = function(){\r\n            that._images.get(img).ready = true;\r\n            if([...that._images.values()].every(elm => elm.ready)){\r\n                that.ready = true;\r\n                that._markerCluster.resetViewport();\r\n                that._markerCluster._createClusters();\r\n            }\r\n        };\r\n        img.src = url;\r\n        return this._images.keys.length - 1;\r\n    }\r\n    loadStyles(styles){\r\n        styles.sort((elm1,elm2) => \r\n        elm1.minThreshold < elm2.minThreshold ? 1 : elm1.minThreshold === elm2.minThreshold ?\r\n         0 : -1); \r\n         let len = styles.length;\r\n         while(len--){\r\n             const style = styles[len];\r\n             this.load(style.url,style.width,style.height,style.minThreshold);\r\n         }\r\n    }\r\n    getIcon(index){\r\n        const result = {\"offset\": { \"x\": 0, \"y\": 0}};\r\n        if(this.useDefault || typeof index === 'undefined'){\r\n            const elm = document.createElement(\"div\");\r\n            const elm2 = document.createElement('div');\r\n            const elm3 = document.createElement('span');\r\n            elm.appendChild(elm2);\r\n            elm2.appendChild(elm3);\r\n            elm.style.width = '40px';\r\n            elm.style.height = '40px';\r\n            elm.style.marginLeft = '-20px';\r\n            elm.style.marginTop = '-20px';\r\n            elm.style.overflow = 'hidden';\r\n            elm.className += ' marker-cluster marker-cluster-small leaflet-marker-icon';\r\n            result.html = elm.outerHTML;\r\n            result.size = {\"width\":40,\"height\":40};\r\n        }else{\r\n            const img = [...this._images.keys()][index];\r\n            const elm = document.createElement(\"div\");\r\n            elm.style.width = `${img.width}px`;\r\n            elm.style.height = `${img.height}px`;\r\n            elm.style.marginLeft = `-${img.width/2}px`;\r\n            elm.style.marginTop = `-${img.height/2}px`;\r\n            elm.style.background = `url('${encodeURI(img.src)}') no-repeat center top`;\r\n            elm.style.lineHeight = elm.style.height;\r\n            elm.style.color = 'black';\r\n            elm.style.fontWeight = 'bold';\r\n            elm.style.textAlign = 'center';\r\n            result.html = elm.outerHTML;\r\n            result.size = {\"width\":img.width,\"height\":img.height};\r\n        }\r\n        return result;\r\n    }\r\n    changeNumber(element,num){\r\n        if(this.useDefault){\r\n            element.children[0].children[0].children[0].innerText = `${num}`;\r\n            const list = element.children[0].classList;\r\n            list.remove('marker-cluster-large');\r\n            list.remove('marker-cluster-medium');\r\n            list.remove('marker-cluster-small');\r\n            if(num < 10){\r\n                list.add('marker-cluster-small');\r\n            }else if(num < 100){\r\n                list.add('marker-cluster-medium');\r\n            }else{\r\n                list.add('marker-cluster-large');\r\n            }\r\n        }else{\r\n            element.children[0].innerText = `${num}`;\r\n            const list = [...this._images.keys()];\r\n            let len = list.length;\r\n            while(len--){\r\n                const img = list[len];\r\n                if(num >= this._images.get(img).minThreshold){\r\n                    let elm = element;\r\n                    elm.style.width = `${img.width}px`;\r\n                    elm.style.height = `${img.height}px`;\r\n                    elm = elm.children[0];\r\n                    elm.style.background = `url('${encodeURI(img.src)}') no-repeat center top`;\r\n                    elm.style.width = `${img.width}px`;\r\n                    elm.style.height = `${img.height}px`;\r\n                    elm.style.lineHeight = elm.style.height;\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n    \r\n}\r\n","export {default as MarkerCluster,Cluster} from './MarkerCluster.js';\r\nexport {default as LLBBox} from './LLBBox.js';\r\n"],"sourceRoot":""}